<!doctype html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Serie Crítica al Liberalismo Económico — CIRCPyCS</title>
  <meta name="description" content="Sitio de la serie 'Crítica al liberalismo económico' del CIRCPyCS: conferencias, conversatorios y publicaciones de Conocimiento y Política." />

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: { 
            brand:'#0E7C7B', 
            brandLight: '#0E9D9C',
            ink:'#0f172a', 
            borderc:'#e5e7eb', 
            bg:'#f6f7fb',
            accent: '#E11D48',
            accentLight: '#FECDD3'
          },
          fontFamily: { 
            sans:['Inter','ui-sans-serif','system-ui','Segoe UI','Roboto','Helvetica Neue','Arial'],
            serif: ['Lora', 'ui-serif', 'Georgia', 'Cambria', 'Times New Roman', 'serif']
          },
          boxShadow: { 
            soft:'0 10px 24px rgba(2,6,23,.08)',
            medium: '0 6px 16px rgba(2,6,23,.12)'
          },
          borderRadius: { 
            xl2:'18px',
            xl3: '24px'
          }
        }
      }
    }
  </script>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Lora:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root{ --header-h: 96px; }
    section[id]{ scroll-margin-top: var(--header-h, 96px); }

    /* Afiches contenidos: nunca sobreponen texto */
    .poster-box{height:300px;display:grid;place-items:center;background:#fff;overflow:hidden}
    @media (min-width:640px){.poster-box{height:380px}}
    @media (min-width:1024px){.poster-box{height:460px}}
    .poster-box img{width:100%;height:100%;object-fit:contain;object-position:center;display:block;margin:auto}

    /* Posters más grandes para conferencias (desktop) */
    .poster-box--lg{height:360px}
    @media (min-width:640px){.poster-box--lg{height:480px}}
    @media (min-width:1024px){.poster-box--lg{height:600px}}

    /* Menú móvil */
    #btn-open[aria-expanded="true"] #icon-bars{display:none}
    #btn-open[aria-expanded="true"] #icon-x{display:block}
    #mobile-menu{ max-height: calc(100dvh - var(--header-h)); overflow:auto; -webkit-overflow-scrolling:touch; }

    .chip{display:inline-flex;align-items:center;gap:.4rem;padding:.25rem .6rem;border-radius:9999px;font-size:.72rem;line-height:1rem}

    /* Efectos de hover para tarjetas */
    .event-card {
      transition: all 0.3s ease;
    }
    .event-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 30px rgba(2,6,23,.15);
    }

    /* Mejoras de accesibilidad */
    @media (prefers-reduced-motion: reduce) {
      .event-card {
        transition: none;
      }
    }

    /* Mejora para el buscador */
    .search-highlight {
      background-color: #FEF08A;
      padding: 0 2px;
      border-radius: 3px;
    }

    /* Botones sociales */
    .social-row{display:flex;flex-wrap:wrap;gap:.5rem}
    .social-btn{display:inline-flex;align-items:center;justify-content:center;width:36px;height:36px;border-radius:9999px;border:1px solid #e5e7eb;background:#fff;transition:all .2s}
    .social-btn:hover{background:#f8fafc;border-color:#0E7C7B;color:#0E7C7B}
    .social-btn svg{width:18px;height:18px}
    .social-btn.is-active{background:#ecfdf5;border-color:#0E7C7B;color:#0E7C7B;box-shadow:0 0 0 2px rgba(14,124,123,.12) inset}
    .social-btn.is-disabled{opacity:.45;pointer-events:none}
  </style>
</head>
<body class="min-h-screen bg-bg text-slate-800 font-sans">
  <!-- Cinta superior -->
  <div class="h-1 w-full bg-gradient-to-r from-emerald-600 via-sky-600 to-rose-600"></div>

  <!-- HEADER -->
  <header class="sticky top-0 z-40 backdrop-blur bg-white/90 border-b border-slate-200 shadow-sm">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex items-center justify-between">
      <a href="#inicio" class="flex items-center gap-3">
        <img src="https://i.imgur.com/ldeXZmG.png" alt="Logo CIRCPyCS" class="h-9 w-9 object-contain" />
        <div class="leading-tight">
          <p class="text-xs tracking-wide text-slate-500">UAGRM</p>
          <h1 class="font-bold text-lg">CIRCPyCS</h1>
        </div>
      </a>
      <nav class="hidden md:flex items-center gap-6 text-sm">
        <a class="hover:text-brand font-medium" href="#conferencias">Conferencias</a>
        <a class="hover:text-brand font-medium" href="#conversatorios">Conversatorios</a>
        <a class="hover:text-brand font-medium" href="#revista">Conocimiento y Política #5</a>
        <a class="hover:text-brand font-medium" href="#contacto">Contacto</a>
        <a class="px-3 py-1.5 rounded-lg border border-slate-300 hover:border-brand hover:text-brand font-medium" href="https://cir.uagrm.edu.bo/" target="_blank" rel="noopener">Volver a inicio</a>
      </nav>
      <button id="btn-open" class="md:hidden inline-flex items-center gap-2 px-3 py-2 rounded-xl border border-slate-200" aria-expanded="false" aria-controls="mobile-menu" aria-label="Abrir menú">
        <span>Menú</span>
        <svg id="icon-bars" width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/></svg>
        <svg id="icon-x" width="20" height="20" viewBox="0 0 24 24" fill="none" class="hidden"><path d="M6 6l12 12M18 6L6 18" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/></svg>
      </button>
    </div>
    <nav id="mobile-menu" class="md:hidden hidden border-t border-slate-200 bg-white shadow-[0_8px_22px_rgba(2,6,23,.08)]" aria-label="Navegación móvil">
      <ul class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 grid gap-1 text-[15px]">
        <li><a class="block px-3 py-2 rounded-lg hover:bg-slate-50 font-medium" href="#conferencias">Conferencias</a></li>
        <li><a class="block px-3 py-2 rounded-lg hover:bg-slate-50 font-medium" href="#conversatorios">Conversatorios</a></li>
        <li><a class="block px-3 py-2 rounded-lg hover:bg-slate-50 font-medium" href="#revista">Conocimiento y Política #5</a></li>
        <li><a class="block px-3 py-2 rounded-lg hover:bg-slate-50 font-medium" href="#contacto">Contacto</a></li>
        <li class="pt-2 mt-2 border-t border-slate-200"><a class="block px-3 py-2 rounded-lg hover:bg-slate-50 font-medium" href="https://cir.uagrm.edu.bo/" target="_blank" rel="noopener">Volver a inicio</a></li>
      </ul>
    </nav>
  </header>

  <!-- HERO -->
  <section id="inicio" class="relative">
    <div class="absolute inset-0 -z-10 opacity-20">
      <div class="absolute -top-24 -left-24 h-64 w-64 rounded-full bg-emerald-500 blur-3xl"></div>
      <div class="absolute -bottom-24 -right-24 h-64 w-64 rounded-full bg-rose-500 blur-3xl"></div>
    </div>
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10 lg:py-14">
      <span class="inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-semibold bg-emerald-50 text-emerald-700 ring-1 ring-emerald-200">Serie académica</span>
      <h2 class="mt-3 text-3xl sm:text-4xl lg:text-5xl font-extrabold text-ink font-serif">Crítica al liberalismo económico</h2>
      <p class="mt-2 max-w-3xl text-slate-600 text-lg">Colección de actividades del CIRCPyCS en torno a debates contemporáneos sobre economía política: conferencias, conversatorios y publicaciones.</p>

      <!-- Buscador global -->
      <div class="mt-5 rounded-2xl border border-borderc bg-white p-4 shadow-soft flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between">
        <div class="text-sm text-slate-600">Usa el buscador para filtrar por ponente, título o tema</div>
        <div class="flex items-center gap-2 w-full lg:w-auto">
          <input id="search" type="search" placeholder="Buscar…" class="w-full lg:w-96 rounded-xl border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-sky-200" />
          <button id="clear" class="px-3 py-2 rounded-xl border border-slate-300 text-sm hover:bg-slate-50 transition-colors">Limpiar</button>
        </div>
      </div>
    </div>
  </section>

  <!-- CONFERENCIAS -->
  <section id="conferencias" class="py-10 bg-white border-y border-slate-200">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between">
        <h3 class="text-2xl font-bold text-ink font-serif">Conferencias</h3>
        <span class="text-xs text-slate-500">Serie 2025</span>
      </div>
      <div id="conf-grid" class="mt-4 grid gap-7 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3"></div>
    </div>
  </section>

  <!-- CONVERSATORIOS -->
  <section id="conversatorios" class="py-10">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between">
        <h3 class="text-2xl font-bold text-ink font-serif">Conversatorios</h3>
        <span class="text-xs text-slate-500">Ordenados del más reciente al más antiguo</span>
      </div>
      <div id="conv-grid" class="mt-4 grid gap-6 sm:grid-cols-2 lg:grid-cols-3"></div>
    </div>
  </section>

  <!-- REVISTA / PUBLICACIÓN -->
  <section id="revista" class="py-12 bg-white border-y border-slate-200">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid lg:grid-cols-2 gap-6 items-center">
        <div class="rounded-3xl border border-slate-200 bg-gradient-to-br from-slate-50 to-slate-100 p-6 lg:p-8 shadow-soft">
          <span class="chip bg-sky-50 text-sky-700 ring-1 ring-sky-200">Publicación</span>
          <h4 class="mt-2 text-2xl font-extrabold font-serif">Conocimiento y Política — N.º 5</h4>
          <p class="mt-2 text-slate-600">Número especial con textos y debates de la serie. Disponible en versión digital para libre descarga. Formato PDF/ISSN. Diseño accesible para lectura en móvil.</p>
          <div class="mt-4 flex flex-wrap gap-3">
            <a href="https://ojs.uagrm.edu.bo/revista-conocimiento-politica" target="_blank" rel="noopener" class="px-4 py-2 rounded-xl bg-ink text-white font-semibold hover:bg-brandLight transition-colors">Abrir en OJS</a>
            <a href="https://cir.uagrm.edu.bo/#publicaciones" target="_blank" rel="noopener" class="px-4 py-2 rounded-xl border border-slate-300 hover:border-brand hover:text-brand transition-colors">Ver publicaciones</a>
          </div>
        </div>
        <div class="rounded-3xl border border-slate-200 bg-white p-4 shadow-soft poster-box">
          <!-- Portada simulada (sigue reglas de contención) -->
          <img src="https://i.imgur.com/boTniYE.png" alt="Portada Conocimiento y Política — N.º 5" />
        </div>
      </div>
    </div>
  </section>

  <!-- CONTACTO -->
  <section id="contacto" class="py-12">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 grid lg:grid-cols-2 gap-8 items-start">
      <div class="rounded-2xl border border-borderc bg-white p-6 shadow-soft">
        <h3 class="font-semibold text-lg">Contacto</h3>
        <p class="mt-2 text-sm text-slate-600">¿Deseas proponer una actividad para la serie?</p>
        <div class="mt-4 grid sm:grid-cols-2 gap-3 text-sm">
          <div class="rounded-xl border border-borderc p-3">
            <div class="text-slate-500">Email</div>
            <a href="mailto:cri.cspoliticas.fcjpsri@uagrm.edu.bo" class="font-medium text-sky-700 hover:text-brand transition-colors">cri.cspoliticas.fcjpsri@uagrm.edu.bo</a>
          </div>
          <div class="rounded-xl border border-borderc p-3">
            <div class="text-slate-500">Teléfono</div>
            <div class="font-medium">+591 67381294</div>
          </div>
        </div>
      </div>
      <div class="rounded-2xl border border-borderc bg-white p-6 shadow-soft">
        <h3 class="font-semibold text-lg">Enviar propuesta</h3>
        <p class="mt-2 text-sm text-slate-600">Incluye título, ponente(s), fecha tentativa y requerimientos técnicos.</p>
        <a href="https://forms.gle/" target="_blank" class="inline-flex items-center gap-2 mt-3 px-4 py-2 rounded-xl bg-slate-900 text-white font-medium hover:bg-brand transition-colors" rel="noopener">Formulario<span>→</span></a>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="border-t border-slate-200 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 text-sm text-slate-600">
      <div class="grid place-items-center gap-3 text-center">
        <p>© <span id="year"></span> Centro de Investigación Regional en Ciencia Política y Ciencias Sociales — UAGRM (CIRCPyCS).</p>
        <p>Contacto: <a class="text-sky-700 hover:underline hover:text-brand transition-colors" href="mailto:cri.cspoliticas.fcjpsri@uagrm.edu.bo">cri.cspoliticas.fcjpsri@uagrm.edu.bo</a> · +591 67381294</p>
      </div>
    </div>
  </footer>

  <script>
    // Año dinámico en el footer
    document.getElementById('year').textContent = new Date().getFullYear();

    // ====== Menú móvil y altura de header ======
    const btnOpen = document.getElementById('btn-open');
    const mobileMenu = document.getElementById('mobile-menu');
    const headerEl = document.querySelector('header');

    function setHeaderVar(){ 
      if (!headerEl) return;
      const h = Math.round(headerEl.getBoundingClientRect().height || 64); 
      document.documentElement.style.setProperty('--header-h', h + 'px'); 
    }

    function toggleMenu(forceOpen = null){
      if (!mobileMenu || !btnOpen) return;
      const willOpen = forceOpen !== null ? forceOpen : mobileMenu.classList.contains('hidden');
      if (willOpen) setHeaderVar();
      mobileMenu.classList.toggle('hidden', !willOpen);
      btnOpen.setAttribute('aria-expanded', String(willOpen));
      document.body.style.overflow = willOpen ? 'hidden' : '';
      if (willOpen) {
        setTimeout(()=> mobileMenu.querySelector('a')?.focus(), 0);
      } else {
        btnOpen.focus();
      }
    }

    btnOpen?.addEventListener('click', ()=> toggleMenu());

    const mq = window.matchMedia('(min-width:768px)');
    const mqHandler = (ev)=>{ if(ev.matches) toggleMenu(false); };
    if (mq.addEventListener) {
      mq.addEventListener('change', mqHandler);
    } else if (mq.addListener) {
      mq.addListener(mqHandler);
    }

    // ====== Datos ======
    const CONVERSATORIOS = [
      {
        id:'conv_2025_10_3',
        title:'3er Conversatorio Crítico sobre Liberalismo Económico',
        date:'2025-10-25',
        time:'18:30',
        mode:'Presencial',
        venue:'Auditorio FCJPSRRII — UAGRM',
        cover:'https://i.imgur.com/j08OAIX.png',
        desc:'Argentina y el giro hacia mayor intervención estatal: implicaciones económicas, políticas y sociales en clave crítica.',
        speakers:['Ricardo Alonzo Fernández Salguero','Matías Suárez Holze']
      },
      {
        id:'conv_2025_10_2',
        title:'2do Conversatorio Crítico sobre Liberalismo Económico',
        date:'2025-10-08',
        time:'18:30',
        mode:'Presencial',
        venue:'Auditorio FCJPSRRII — UAGRM',
        cover:'https://i.imgur.com/5Kg6aDu.png',
        desc:'Inflación, deuda y reformas en Argentina: apertura de mercados, rol del BCRA y alcance de las políticas sociales.',
        speakers:['Nicolás Di Paola','Ricardo Alonzo Fernández Salguero'],
        fb:'https://www.facebook.com/share/v/1CjsbfFgDQ/',
        ig:'https://www.instagram.com/p/DRkV9FgDm8V/?utm_source=ig_web_copy_link&igsh=MzRlODBiNWFlZA==',
        drive:'https://drive.google.com/file/d/1VjgDKY4tXxAf_GkuM7fvf2U3F0ol3FHH/view?usp=sharing',
        yt:'https://youtu.be/hzHotYQZGbc?si=jSEC9stDy7Fkq5b2'
      },
      {
        id:'conv_2025_09_1',
        title:'1er Conversatorio crítico sobre el liberalismo económico',
        date:'2025-09-20',
        time:'19:00',
        mode:'Híbrido',
        venue:'Sala de Posgrado & Zoom — UAGRM',
        cover:'https://i.imgur.com/nhffCet.png',
        desc:'Experimentos libertarios, mitos del Índice de Libertad Económica y balance de la administración Milei; efectos para Bolivia.',
        speakers:['Eduardo Garzón','Ricardo Alonzo Fernández'],
        x:'https://x.com/circpycs/status/1994072560107942152?s=20',
        ig:'https://www.instagram.com/p/DRkMQUIDlRC/?utm_source=ig_web_copy_link&igsh=MzRlODBiNWFlZA==',
        yt:'https://youtu.be/7UTjLsrbuWY?si=Zhd_bhP_G-WOMKrf',
        fb:'https://www.facebook.com/share/v/17RFwViTbB/',
        drive:'https://drive.google.com/file/d/1YZ4_5bybA1-kVuiMRKBXgLpbiM797H49/view?usp=sharing'
      }
    ];

    const CONFERENCIAS = [
      { 
        id:'conf_2025_urbina',
        date:'2025-06-23',
        time:'18:30',
        mode:'Híbrido',
        venue:'Sala de Posgrado & Zoom — UAGRM',
        title:'El fracaso del liberalismo en explicar el desarrollo de los países',
        cover:'https://i.imgur.com/QdUViuY.png',
        speakers:['Dante Urbina'],
        yt:'https://youtu.be/yUCQ1M2qiJI?si=YfkpnfXq55d6Ge5-',
        fb:'https://www.facebook.com/share/v/17TJyiJjEk/',
        drive:'https://drive.google.com/file/d/1ub2fDl5R8Th4K3eXlg-3bxiCKIXnvIK9/view?usp=sharing'
      },
      { 
        id:'conf_2025_meta',
        date:'2025-05-15',
        time:'19:00',
        mode:'Presencial',
        venue:'Auditorio FCJPSRRII — UAGRM',
        title:'¿No es opinión, es evidencia? Por qué los políticos deben hablar de meta-análisis',
        cover:'https://i.imgur.com/Z5qXo10.png',
        speakers:['Ricardo Alonzo Fernández'],
        yt:'https://youtu.be/81n5IhLifm0?si=A7Q3pibn7ALTOtC_',
        fb:'https://www.facebook.com/share/v/1K4YoM5N8W/'
      },
      { 
        id:'conf_2025_mokre',
        date:'2025-08-15',
        time:'18:30',
        mode:'Presencial',
        venue:'Aula Magna — UAGRM',
        title:'¿Existe evidencia de la teoría del valor-trabajo de Marx?',
        cover:'https://i.imgur.com/ttOVFpH.png',
        speakers:['Patrick Mokre'],
        x:'https://x.com/circpycs/status/1975257534656122998?s=20',
        yt:'https://youtu.be/t4rHp6G2YJs?si=yD9mlLEIVXGA4FMs',
        fb:'https://www.facebook.com/share/v/1HVEP6Cvj3/',
        drive:'https://drive.google.com/file/d/1SvuK18wxLdzmGOw_hW2CIS46z6Qb-iwv/view?usp=sharing'
      },
      { 
        id:'conf_2025_thomas',
        date:'2025-08-28',
        time:'18:30',
        mode:'Presencial',
        venue:'Aula Magna — UAGRM',
        title:'La política de la microeconomía y los límites del liberalismo económico',
        cover:'https://i.imgur.com/9dBaFRH.png',
        speakers:['Alex M. Thomas'],
        fb:'https://www.facebook.com/share/v/14Tzi9K1rHb/',
        drive:'https://drive.google.com/file/d/1bdtboLphEdyCRpcaaWDSwEojSH0JZg-B/view?usp=sharing'
      },
      { 
        id:'conf_2025_montoya',
        date:'2025-09-30',
        time:'13:00',
        mode:'Virtual',
        venue:'Transmisión en vivo — UAGRM',
        title:'¿Más desigualdad es menor democracia?',
        cover:'https://i.imgur.com/JCwxUXh.png',
        desc:'Cómo la percepción de la desigualdad impacta en la calidad democrática, actitudes sociopolíticas y cooperación.',
        speakers:['Dra. Mar Montoya Lozano'],
        fb:'https://www.facebook.com/share/v/18Fxf62asL/',
        drive:'https://drive.google.com/file/d/1FKq3lUlHTcH5_n6vo9S7KjSAXfETcVn2/view?usp=sharing'
      },
      { 
        id:'conf_2025_cockshott_1',
        date:'2025-11-05',
        time:'11:00',
        mode:'Virtual',
        venue:'Transmisión en vivo — UAGRM',
        title:'Una Crítica a Hayek',
        cover:'https://i.imgur.com/2TCvz2C.png',
        desc:'Crítica a la imposibilidad de la planificación',
        fb:'https://www.facebook.com/share/v/16jPGwA5YV/',
        speakers:['Dr. Paul Cockshott'],
        drive:'https://drive.google.com/file/d/11PjmNc5X-UWhKiHA-jZlppbtXB6zy2Hg/view?usp=sharing'
      },
      {
        id:'conf_2025_bel',
        date:'2025-12-16',
        time:'12:30',
        mode:'Virtual',
        venue:'Transmisión en vivo — UAGRM',
        title:'Germà Bel — título por confirmar',
        cover:'https://i.imgur.com/30zzUVj.png',
        speakers:['Germà Bel (UB)']
      },
      {
        id:'conf_2025_pozo',
        date:'2025-10-16',
        time:'12:10',
        mode:'Virtual',
        venue:'Transmisión en vivo — UAGRM',
        title:'Antony Pozo — título por confirmar',
        cover:'https://i.imgur.com/qKZUErn.png',
        speakers:['Antony Pozo'],
        fb:'https://www.facebook.com/share/v/1B4RRg5djE/',
        drive:'https://drive.google.com/file/d/1zzIcRrqR8i4Z9Qqc03DEJn_gZOO7RZ6g/view?usp=sharing'
      },
      { 
        id:'conf_2025_cockshott_2',
        date:'2025-10-24',
        time:'12:00',
        mode:'Virtual',
        venue:'Transmisión en vivo — UAGRM',
        title:'Defensa ante Críticas Comunes al Marxismo',
        cover:'https://i.imgur.com/mTzbptb.png',
        desc:'Crítica a la imposibilidad de la planificación',
        speakers:['Angel Barroso']
      }
    ];

    const ORDER_WEIGHTS = {
      conf_2025_bel: 3,
      conf_2025_pozo: 2,
      conf_2025_cockshott_1: 1
    };

    const fmtDate = (iso) => new Date(iso + 'T00:00:00').toLocaleDateString('es-BO', {
      year:'numeric',
      month:'short',
      day:'2-digit'
    });

    function escapeRegExp(str) {
      return str.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
    }

    // Función para resaltar texto de búsqueda
    function highlightText(text, searchTerm) {
      if (!searchTerm) return text;
      const safe = escapeRegExp(searchTerm);
      const regex = new RegExp('(' + safe + ')', 'gi');
      return text.replace(regex, '<span class="search-highlight">$1</span>');
    }

    // Copiar enlace al portapapeles (preparado por si se quiere usar más adelante)
    function copyLink(url, btn){
      navigator.clipboard.writeText(url).then(()=>{
        if (!btn) return;
        const old = btn.innerHTML;
        btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none"><path d="M5 12l4 4L19 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>Copiado';
        setTimeout(()=> btn.innerHTML = old, 1400);
      }).catch(()=>{
        alert('No se pudo copiar el enlace.');
      });
    }

    const socialIcons = {
      x:`<svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M4 4l16 16M20 4L4 20" stroke="currentColor" stroke-width="2"/></svg>`,
      ig:`<svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><rect x="3" y="3" width="18" height="18" rx="5" stroke="currentColor" stroke-width="2"/><circle cx="12" cy="12" r="4" stroke="currentColor" stroke-width="2"/><circle cx="17.5" cy="6.5" r="1.5" fill="currentColor"/></svg>`,
      fb:`<svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M13 21v-8h3l1-4h-4V7a1 1 0 011-1h3V2h-3a5 5 0 00-5 5v2H6v4h3v8h4z" fill="currentColor"/></svg>`,
      yt:`<svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><rect x="3" y="6" width="18" height="12" rx="3" stroke="currentColor" stroke-width="2"/><path d="M10 10l5 3-5 3v-6z" fill="currentColor"/></svg>`,
      drive:`<svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M7 17l5-9 5 9H7z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/><path d="M7 17l-3 5h6l3-5H7zm10 0l3 5h-6" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/></svg>`
    };

    const card = (type, ev, searchTerm = '') => {
      const titleHighlighted = highlightText(ev.title, searchTerm);
      const descHighlighted = ev.desc ? highlightText(ev.desc, searchTerm) : '';
      const speakersHighlighted = ev.speakers ? highlightText(ev.speakers.join(', '), searchTerm) : '';
      const venueHighlighted = highlightText(ev.venue, searchTerm);
      const shareUrl = (typeof location !== 'undefined' ? (location.origin + location.pathname + '#' + ev.id) : ('#' + ev.id));
      const xUrl = ev.x || `https://twitter.com/intent/tweet?url=${encodeURIComponent(shareUrl)}&text=${encodeURIComponent(ev.title)}`;
      const fbUrl = ev.fb || `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl)}`;
      const igUrl = ev.ig || '#';
      const ytUrl = ev.yt || '#';
      const driveUrl = ev.drive || '#';
      const clsX = 'social-btn' + (ev.x ? ' is-active' : '');
      const clsIG = 'social-btn' + (ev.ig ? ' is-active' : ' is-disabled');
      const clsFB = 'social-btn' + (ev.fb ? ' is-active' : '');
      const clsYT = 'social-btn' + (ev.yt ? ' is-active' : ' is-disabled');
      const clsDrive = 'social-btn' + (ev.drive ? ' is-active' : ' is-disabled');

      return `
      <article id="${ev.id}" class="rounded-xl2 bg-white border border-borderc shadow-soft overflow-hidden flex flex-col event-card h-full">
        <div class="relative ${type==='conf'?'poster-box poster-box--lg':'poster-box'} border-b border-borderc p-2 sm:p-3">
          <img loading="lazy" decoding="async" src="${ev.cover}" alt="Afiche: ${ev.title}"
               onerror="this.onerror=null;this.src='https://images.unsplash.com/photo-1529070538774-1843cb3265df?q=80&w=1200&auto=format&fit=crop'"/>
          <div class="absolute top-2 left-2 space-x-1">
            <span class="chip ${type==='conv'?'bg-sky-50 text-sky-700 ring-1 ring-sky-200':'bg-accentLight text-accent ring-1 ring-accent'}">${type==='conv'?'Conversatorio':'Conferencia'}</span>
          </div>
        </div>
        <div class="p-5 flex-1 flex flex-col">
          <h4 class="font-semibold text-ink">${titleHighlighted}</h4>
          ${ev.desc?`<p class="mt-1 text-sm text-slate-600">${descHighlighted}</p>`:''}
          <div class="mt-3 text-sm text-slate-700 space-y-1">
            <div><span class="font-medium">Fecha:</span> ${fmtDate(ev.date)} · ${ev.time} · ${ev.mode}</div>
            <div class="truncate"><span class="font-medium">Lugar:</span> ${venueHighlighted}</div>
            ${ev.speakers?`<div class="truncate"><span class="font-medium">Ponente(s):</span> ${speakersHighlighted}</div>`:''}
          </div>
          <div class="mt-4 pt-3 border-t border-slate-200">
            <div class="social-row" aria-label="Enlaces oficiales">
              <a class="${clsX}" target="_blank" rel="noopener" aria-label="X" href="${xUrl}">${socialIcons.x}</a>
              <a class="${clsIG}" target="_blank" rel="noopener" aria-label="Instagram" href="${igUrl}">${socialIcons.ig}</a>
              <a class="${clsFB}" target="_blank" rel="noopener" aria-label="Facebook" href="${fbUrl}">${socialIcons.fb}</a>
              <a class="${clsYT}" target="_blank" rel="noopener" aria-label="YouTube" href="${ytUrl}">${socialIcons.yt}</a>
              <a class="${clsDrive}" target="_blank" rel="noopener" aria-label="Descargar en Drive" href="${driveUrl}">${socialIcons.drive}</a>
            </div>
          </div>
        </div>
      </article>`;
    };

    function render(){
      const searchInput = document.getElementById('search');
      const q = (searchInput?.value || '').trim().toLowerCase();
      const match = (ev)=> {
        if (!q) return true;
        const haystack = (ev.title + ' ' + (ev.desc||'') + ' ' + (ev.venue||'') + ' ' + (ev.speakers||'').toString()).toLowerCase();
        return haystack.includes(q);
      };

      const conv = CONVERSATORIOS
        .filter(match)
        .sort((a,b)=> b.date.localeCompare(a.date));

      const conf = CONFERENCIAS
        .filter(match)
        .sort((a,b)=>{
          const byDate = b.date.localeCompare(a.date);
          if (byDate !== 0) return byDate;
          const wa = ORDER_WEIGHTS[a.id] || 0;
          const wb = ORDER_WEIGHTS[b.id] || 0;
          return wb - wa;
        });

      const convGrid = document.getElementById('conv-grid');
      const confGrid = document.getElementById('conf-grid');

      if (convGrid) {
        convGrid.innerHTML = conv.length
          ? conv.map(ev=>card('conv',ev,q)).join('')
          : `<div class="text-sm text-slate-500 col-span-full py-10 text-center">No se encontraron conversatorios que coincidan con la búsqueda.</div>`;
      }

      if (confGrid) {
        confGrid.innerHTML = conf.length
          ? conf.map(ev=>card('conf',ev,q)).join('')
          : `<div class="text-sm text-slate-500 col-span-full py-10 text-center">No se encontraron conferencias que coincidan con la búsqueda.</div>`;
      }
    }

    const searchEl = document.getElementById('search');
    const clearEl = document.getElementById('clear');

    searchEl?.addEventListener('input', render);
    clearEl?.addEventListener('click', ()=>{ 
      if (!searchEl) return;
      searchEl.value=''; 
      render(); 
      searchEl.focus();
    });

    // Init
    (function(){ 
      setHeaderVar(); 
      render(); 
    })();

    window.addEventListener('resize', ()=>{ setHeaderVar(); });
  </script>
</body>
</html>
