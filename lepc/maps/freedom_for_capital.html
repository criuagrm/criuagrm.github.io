<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Análisis Estructural: Freedom for Capital</title>
<script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,300;0,400;0,700;1,300&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

<style>
  :root {
    --bg-main: #ffffff;
    --sidebar-bg: #f8f9fa;
    --text-body: #333333;
    --text-header: #1a1a1a;
    --accent: #2c3e50;
    --border: #e9ecef;
    --highlight: #8c2f39; /* Rojo académico para énfasis */
  }

  body {
    font-family: 'Inter', sans-serif;
    margin: 0; padding: 0;
    height: 100vh;
    display: flex;
    background-color: var(--bg-main);
    color: var(--text-body);
    overflow: hidden;
  }

  /* --- BARRA LATERAL (FICHA TÉCNICA) --- */
  .sidebar {
    width: 450px;
    background: var(--sidebar-bg);
    border-right: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    z-index: 20;
    box-shadow: 2px 0 10px rgba(0,0,0,0.05);
    overflow: hidden;
    transition: transform 0.3s ease;
  }

  .sidebar.closed {
    transform: translateX(-100%);
    position: absolute;
    height: 100%;
  }

  .header {
    padding: 30px;
    background: white;
    border-bottom: 2px solid var(--accent);
  }

  .header h1 {
    font-family: 'Merriweather', serif;
    font-size: 1.4rem;
    color: var(--text-header);
    margin: 0 0 10px 0;
    line-height: 1.3;
  }

  .header .meta {
    font-size: 0.75rem;
    color: #666;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .filters {
    padding: 15px 30px;
    border-bottom: 1px solid var(--border);
    background: #fff;
  }

  .filter-btn {
    display: block;
    width: 100%;
    padding: 8px 0;
    text-align: left;
    background: none;
    border: none;
    font-size: 0.8rem;
    color: #555;
    cursor: pointer;
    border-bottom: 1px dotted #ccc;
    transition: color 0.2s;
  }
  .filter-btn:hover { color: var(--highlight); }

  .content-area {
    flex-grow: 1;
    overflow-y: auto;
    padding: 30px;
  }

  /* ESTILOS DE LA FICHA DE CONTENIDO */
  .node-type {
    font-size: 0.65rem;
    text-transform: uppercase;
    font-weight: 700;
    color: var(--highlight);
    margin-bottom: 5px;
    display: block;
  }

  .node-title {
    font-family: 'Merriweather', serif;
    font-size: 1.5rem;
    color: var(--accent);
    margin: 0 0 20px 0;
    border-bottom: 1px solid #ddd;
    padding-bottom: 15px;
  }

  .section-header {
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    color: #444;
    margin-top: 25px;
    margin-bottom: 10px;
    border-left: 3px solid var(--accent);
    padding-left: 10px;
  }

  .mechanism-box {
    background: #fff;
    border: 1px solid #e0e0e0;
    padding: 15px;
    margin-bottom: 10px;
    border-radius: 4px;
  }
  
  .mech-label {
    font-size: 0.7rem;
    font-weight: 600;
    color: #666;
    display: block;
    margin-bottom: 5px;
  }

  .text-body {
    font-size: 0.9rem;
    line-height: 1.6;
    color: #333;
    text-align: justify;
  }

  .data-highlight {
    background: #f1f3f5;
    padding: 10px;
    font-family: 'Merriweather', serif;
    font-style: italic;
    font-size: 0.85rem;
    border-left: 3px solid var(--highlight);
    margin: 15px 0;
  }

  .citation {
    font-size: 0.75rem;
    color: #777;
    margin-top: 5px;
    text-align: right;
  }

  .footer {
    padding: 15px;
    background: #fff;
    border-top: 1px solid var(--border);
    font-size: 0.7rem;
    text-align: center;
    color: #888;
  }

  /* --- RED VIS.JS --- */
  #network {
    flex-grow: 1;
    background: #ffffff;
  }

  .controls {
    position: absolute;
    bottom: 20px; right: 20px;
    z-index: 100;
  }
  
  .btn-control {
    background: white; border: 1px solid #ccc;
    padding: 8px 15px; cursor: pointer;
    font-size: 0.8rem; border-radius: 3px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  }

</style>
</head>
<body>

<div class="sidebar" id="sidebar">
  <div class="header">
    <h1>Freedom for Capital,<br>Not People</h1>
    <div class="meta">Matthias Schmelzer (2010)</div>
    <div class="meta" style="margin-top:5px; font-weight:600;">Análisis: Ricardo Alonzo Fernández Salguero</div>
  </div>

  <div class="filters">
    <button class="filter-btn" onclick="focusNode(1)">1. Intro: El Sistema Bretton Woods</button>
    <button class="filter-btn" onclick="focusNode(4)">2. El Cisma Interno (MPS)</button>
    <button class="filter-btn" onclick="focusNode(8)">3. Estrategia de Redes (Bellagio)</button>
    <button class="filter-btn" onclick="focusNode(12)">4. Conclusión: El Nuevo Orden</button>
  </div>

  <div class="content-area" id="infoPanel">
    <div style="text-align: center; margin-top: 40%; color: #999;">
      <p style="font-family: 'Merriweather', serif; font-style: italic;">Seleccione un nodo para visualizar<br>el análisis estructural detallado.</p>
    </div>
  </div>

  <div class="footer">
    Análisis Estructural y Mecanismos Causales
  </div>
</div>

<div id="network"></div>
<div class="controls">
  <button class="btn-control" onclick="fitAll()">Centrar Gráfico</button>
</div>

<script>
// --- BASE DE DATOS ESTRUCTURAL ---
const bookData = {
  // INTRODUCCIÓN Y CAPÍTULO 1
  1: {
    type: "Contexto Estructural",
    title: "El Sistema Bretton Woods (1944)",
    mechanisms: [
      { level: "Macro", desc: "Régimen de tipos de cambio fijos pero ajustables + Controles de Capital." },
      { level: "Meso", desc: "Autonomía de la política monetaria nacional (Keynesianismo) protegida de los flujos especulativos." }
    ],
    text: "El sistema de posguerra se diseñó explícitamente para subordinar las finanzas internacionales a la economía doméstica y al empleo. Los controles de capital eran la norma aceptada, no la excepción.",
    evidence: "La Carta del FMI (Art. VI) permitía explícitamente controles de capital para evitar fugas. Schmelzer cita a Ragnar Nurkse (1944): 'Currency exchanges cannot be left free to fluctuate'.",
    ref: "Schmelzer, Intro & Cap 1, pp. 36-38."
  },
  2: {
    type: "Actor Colectivo",
    title: "Mont Pèlerin Society (MPS)",
    mechanisms: [
      { level: "Meso", desc: "Formación de una 'comunidad epistémica' transnacional para refinar y diseminar ideas neoliberales." },
      { level: "Micro", desc: "Estrategia de Hayek: Influir en los intelectuales ('second-hand dealers in ideas') para cambiar el clima de opinión a largo plazo." }
    ],
    text: "Fundada en 1947, la MPS veía a Bretton Woods como una amenaza 'totalitaria' porque los controles de capital impedían la disciplina del mercado sobre los gobiernos democráticos.",
    evidence: "Friedman (1962): 'Los controles de cambio son el paso más efectivo hacia una sociedad autoritaria'.",
    ref: "Schmelzer, Cap 1, pp. 22-25."
  },
  3: {
    type: "Teoría Económica",
    title: "El Trilema Político",
    mechanisms: [
      { level: "Macro", desc: "Imposibilidad de tener simultáneamente: 1) Tipo de cambio fijo, 2) Libre movilidad de capital, 3) Autonomía monetaria." }
    ],
    text: "Schmelzer utiliza este teorema para explicar el conflicto. Bretton Woods sacrificó el capital (2). La MPS quería sacrificar la autonomía (3) o el tipo fijo (1) para liberar el capital.",
    evidence: "Gráfico de la p. 36: Muestra cómo diferentes regímenes resuelven el trilema.",
    ref: "Schmelzer, Cap 1, pp. 36."
  },

  // CAPÍTULO 2
  4: {
    type: "Conflicto Interno",
    title: "El Cisma: Oro vs. Flexibilidad",
    mechanisms: [
      { level: "Micro", desc: "Conflicto generacional y teórico. La 'Vieja Guardia' (Mises/Rueff) vs. Escuela de Chicago (Friedman/Machlup)." },
      { level: "Meso", desc: "Debates en conferencias de la MPS (especialmente Turín 1961 y Stresa 1965)." }
    ],
    text: "Durante los años 50 y 60, la MPS estuvo dividida. Los 'ortodoxos' querían volver al Patrón Oro para disciplinar al estado. Los 'modernos' argumentaban que el Patrón Oro era políticamente inviable y abogaban por tipos flotantes.",
    evidence: "Ruptura personal: Mises dejó de hablarle a Machlup (su alumno) después de que este último comparara a los defensores del oro con sindicalistas en 1965.",
    ref: "Schmelzer, Cap 2, pp. 76."
  },
  5: {
    type: "Argumento Teórico",
    title: "La 'Assumption' de Irrealismo",
    mechanisms: [
      { level: "Micro", desc: "Argumento retórico de Friedman y Haberler." }
    ],
    text: "Friedman argumentó que, dado que los salarios eran rígidos (por los sindicatos), el ajuste vía deflación (Patrón Oro) era imposible sin causar desempleo masivo, lo que llevaría a más controles estatales. La única salida liberal era flotar la moneda.",
    evidence: "Friedman en la conferencia MPS de 1950 y su ensayo 'The Case for Flexible Exchange Rates' (1953).",
    ref: "Schmelzer, Cap 2, pp. 58-59."
  },

  // CAPÍTULO 3
  6: {
    type: "Mecanismo de Difusión",
    title: "El Grupo Bellagio (1963-1964)",
    mechanisms: [
      { level: "Meso", desc: "Creación de redes académico-políticas. Fritz Machlup organizó reuniones entre académicos (MPS) y banqueros centrales." }
    ],
    text: "Machlup (miembro clave de la MPS) creó un foro 'neutral' para legitimar la discusión de los tipos flexibles, que hasta entonces eran tabú en círculos oficiales. Lograron redefinir el problema no como 'falta de liquidez' sino como 'problema de ajuste'.",
    evidence: "El informe de 1964 del Grupo Bellagio introdujo la taxonomía que marginó las soluciones keynesianas y elevó la flexibilidad como opción técnica.",
    ref: "Schmelzer, Cap 3, pp. 91-93."
  },
  7: {
    type: "Estrategia de Cooptación",
    title: "Conferencias de Bürgenstock (1969)",
    mechanisms: [
      { level: "Meso", desc: "Alianza con el capital privado. Reuniones diseñadas para convertir a los banqueros privados a la causa de la flexibilidad." }
    ],
    text: "Los académicos de la MPS convencieron a los banqueros internacionales de que los tipos flotantes no eran un riesgo (caos), sino la única forma de evitar los controles de capital (que dañaban sus ganancias).",
    evidence: "Encuesta final de la conferencia: 'A large majority... favored greater flexibility'. El consenso bancario cambió radicalmente en 1969.",
    ref: "Schmelzer, Cap 3, pp. 109."
  },
  8: {
    type: "Influencia Política",
    title: "El Shock de Nixon (1971)",
    mechanisms: [
      { level: "Micro", desc: "Asesoramiento directo. Friedman, Shultz y Haberler tenían acceso directo a la administración Nixon." },
      { level: "Macro", desc: "Estrategia de 'Benign Neglect' (Descuido Benigno) hacia el déficit de EE.UU." }
    ],
    text: "La decisión de Nixon de cerrar la ventanilla de oro no fue solo pragmática; siguió un guion neoliberal para desmantelar Bretton Woods sin reemplazarlo por un sistema coordinado.",
    evidence: "Memorándum de Friedman a Nixon (1968): 'A Proposal for Resolving US Balance of Payments Problems'. El comunicado final de 1971 reflejaba estas ideas.",
    ref: "Schmelzer, Cap 3, pp. 111-115."
  },

  // CONCLUSIÓN
  9: {
    type: "Resultado Estructural",
    title: "El Orden Monetario Neoliberal",
    mechanisms: [
      { level: "Macro", desc: "Disciplina de mercado reemplaza la disciplina estatal. La fuga de capitales se convierte en el mecanismo de sanción contra políticas sociales." }
    ],
    text: "El fin de Bretton Woods permitió la financiarización global. La libertad para el capital significó una restricción estructural para la democracia y las políticas de redistribución.",
    evidence: "Datos de volatilidad y crecimiento del mercado de divisas (Forex) que pasó de financiar comercio a pura especulación (70 veces el volumen del comercio real en 2010).",
    ref: "Schmelzer, Conclusión, pp. 123."
  }
};

// --- NODOS Y ARISTAS ---
const nodes = new vis.DataSet([
  // Nodos conceptuales (Rectángulos)
  { id: 1, label: "Bretton Woods\n(Status Quo)", shape: "box", color: {background: "#e9ecef", border: "#adb5bd"} },
  { id: 2, label: "MPS\n(Mont Pèlerin)", shape: "box", color: {background: "#dbe4ff", border: "#4c6ef5"} },
  { id: 3, label: "Trilema\nPolítico", shape: "box", color: {background: "#fff3bf", border: "#fcc419"} },
  
  // Nodos de actores (Elipses)
  { id: 4, label: "Facción Oro\n(Mises/Rueff)", shape: "ellipse", color: {background: "#ffe3e3", border: "#fa5252"} },
  { id: 5, label: "Facción Flexible\n(Friedman/Machlup)", shape: "ellipse", color: {background: "#d3f9d8", border: "#2b8a3e"} },
  
  // Nodos de Eventos/Estrategia (Diamantes)
  { id: 6, label: "Grupo Bellagio\n(1964)", shape: "diamond", color: {background: "#e7f5ff", border: "#228be6"} },
  { id: 7, label: "Bürgenstock\n(1969)", shape: "diamond", color: {background: "#e7f5ff", border: "#228be6"} },
  { id: 8, label: "Shock Nixon\n(1971)", shape: "diamond", color: {background: "#ffec99", border: "#f08c00"} },
  
  // Resultado (Estrella)
  { id: 9, label: "Orden Neoliberal\n(Financiarización)", shape: "star", size: 30, color: {background: "#343a40", border: "#000"} }
]);

const edges = new vis.DataSet([
  { from: 1, to: 2, label: "provoca creación", arrows: "to", dashes: true },
  { from: 2, to: 3, label: "analiza", arrows: "to" },
  { from: 2, to: 4, label: "contiene", arrows: "to" },
  { from: 2, to: 5, label: "contiene", arrows: "to" },
  { from: 4, to: 5, label: "cisma teórico", arrows: "to;from", width: 2 },
  { from: 5, to: 6, label: "Machlup organiza", arrows: "to" },
  { from: 6, to: 7, label: "evoluciona a", arrows: "to" },
  { from: 5, to: 8, label: "Friedman asesora", arrows: "to", width: 2 },
  { from: 7, to: 8, label: "legitima", arrows: "to" },
  { from: 8, to: 1, label: "destruye", arrows: "to", color: {color:"red"} },
  { from: 8, to: 9, label: "instaura", arrows: "to", width: 3 }
]);

// --- CONFIGURACIÓN DE LA RED ---
const container = document.getElementById('network');
const data = { nodes: nodes, edges: edges };
const options = {
  nodes: {
    font: { size: 14, face: 'Inter', color: '#333' },
    borderWidth: 2,
    shadow: true
  },
  edges: {
    width: 1,
    color: { color: '#999', highlight: '#2c3e50' },
    font: { size: 10, align: 'middle', background: 'white' },
    smooth: { type: 'cubicBezier', roundness: 0.5 }
  },
  physics: {
    enabled: true,
    solver: 'forceAtlas2Based',
    forceAtlas2Based: {
      gravitationalConstant: -100,
      centralGravity: 0.01,
      springLength: 200,
      springConstant: 0.08
    },
    stabilization: { iterations: 200 }
  },
  interaction: { hover: true }
};

const network = new vis.Network(container, data, options);

// --- INTERACCIÓN ---
network.on("click", function (params) {
  if (params.nodes.length > 0) {
    const nodeId = params.nodes[0];
    const info = bookData[nodeId];
    
    // Abrir sidebar si está cerrado
    const sidebar = document.getElementById('sidebar');
    if (sidebar.classList.contains('closed')) sidebar.classList.remove('closed');
    
    if (info) {
      let mechHtml = info.mechanisms.map(m => 
        `<div class="mechanism-box">
           <span class="mech-label">Mecanismo ${m.level}:</span>
           ${m.desc}
         </div>`
      ).join('');

      document.getElementById('infoPanel').innerHTML = `
        <span class="node-type">${info.type}</span>
        <h2 class="node-title">${info.title}</h2>
        
        <div class="section-header">Mecanismos Causales</div>
        ${mechHtml}
        
        <div class="section-header">Análisis</div>
        <p class="text-body">${info.text}</p>
        
        <div class="data-highlight">
          ${info.evidence}
        </div>
        
        <div class="citation">
          Fuente: ${info.ref}
        </div>
      `;
    }
  }
});

// Funciones de control
function focusNode(nodeId) {
  network.selectNodes([nodeId]);
  network.focus(nodeId, { scale: 1.2, animation: true });
  // Disparar evento de click manualmente
  network.emit('click', { nodes: [nodeId] });
}

function fitAll() {
  network.fit({ animation: { duration: 1000 } });
}

// Carga inicial
window.onload = function() {
  setTimeout(fitAll, 500);
};

</script>
</body>
</html>
