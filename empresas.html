<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Role Play — Dado & Formas de Empresa (Bolivia)</title>
  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme:{extend:{colors:{ink:'#0f172a',muted:'#64748b',line:'rgba(148,163,184,.25)'}}}
    }
  </script>
  <style>
    body{background:#f8f9fa}
    .die{box-shadow:0 8px 20px rgba(2,6,23,.5), inset 0 0 24px rgba(59,130,246,.12)}
    .roll{animation:wiggle .6s ease-in-out}
    @keyframes wiggle{0%{transform:rotate(0) scale(1)}25%{transform:rotate(8deg) scale(1.05)}50%{transform:rotate(-6deg) scale(1.04)}75%{transform:rotate(4deg) scale(1.02)}100%{transform:rotate(0) scale(1)}}
  .pip-glow{color:#fff;text-shadow:0 0 10px rgba(255,255,255,.9),0 0 22px rgba(34,211,238,.7),0 0 44px rgba(34,211,238,.35)}
  </style>
</head>
<body class="min-h-screen bg-[#f8f9fa] text-slate-800 font-sans">
  <!-- Header -->
  <header class="sticky top-0 z-10 bg-[#2c3e50] text-white border-b border-black/10 px-4 py-2 shadow">
    <div class="max-w-6xl mx-auto flex items-center justify-between gap-3">
      <div class="flex items-center gap-3">
        <span class="font-extrabold tracking-wide text-sm sm:text-base">Formas de Empresa — Bolivia</span>
        <span class="text-[11px] sm:text-xs text-slate-200/80">Código de Comercio \+ Leyes Especiales</span>
      </div>
      <label class="flex items-center gap-2 text-xs text-slate-200/80 select-none">
        <input id="toggleSpecial" type="checkbox" class="accent-cyan-400 w-3.5 h-3.5" />
        Incluir cooperativas/EP en el dado
      </label>
    </div>
  </header>

  <!-- Dice -->
  <section class="max-w-6xl mx-auto px-4 pt-3">
    <div class="flex items-center gap-3">
      <div id="die" role="button" tabindex="0" aria-label="Lanzar dado (clic o barra espaciadora)" class="die w-[min(18vmin,148px)] h-[min(18vmin,148px)] rounded-xl bg-gradient-to-br from-slate-800 to-slate-900 border border-line grid place-items-center cursor-pointer select-none transition-transform active:scale-95" data-testid="die">
        <div id="pip" class="text-white pip-glow text-[clamp(48px,10vmin,96px)] font-black">—</div>
      </div>
      <div class="text-xs sm:text-sm text-slate-400">
        Clic o <kbd class="px-1 py-0.5 rounded bg-slate-800 border border-line">Espacio</kbd> para lanzar. <br class="hidden sm:block"/>Las caras del dado se mapean a las tarjetas visibles (ordenadas de izquierda a derecha). Por defecto solo figuras del <em>Código de Comercio</em>. Activa el switch para incluir <em>Cooperativas</em> y <em>Empresa Pública</em>.
      </div>
    </div>
  </section>

  <!-- Grid CODE COMMERCE -->
  <main class="max-w-6xl mx-auto px-4">
    <h2 class="mt-3 mb-2 text-[13px] font-semibold text-slate-300">Código de Comercio (dados 1–6)</h2>
    <section id="cards-code" class="grid gap-3 grid-cols-2 md:grid-cols-3 xl:grid-cols-6">
      <!-- JS render -->
    </section>

    <h2 class="mt-5 mb-2 text-[13px] font-semibold text-slate-300">Leyes especiales (fuera del Código de Comercio)</h2>
    <section id="cards-special" class="grid gap-3 grid-cols-2 md:grid-cols-3 xl:grid-cols-6">
      <!-- JS render -->
    </section>
  </main>

  <!-- Leyenda -->
  <footer class="mt-3 border-t border-slate-200 py-2 text-[11px] text-slate-600 px-4">
    <div id="legend" class="max-w-7xl mx-auto flex flex-wrap gap-1.5"></div>
  </footer>

  <script>
    // =============================
    // Datos base (compactos)
    // =============================
    const CODE_TYPES = [
      { idx:1, id:'unipersonal', nombre:'Empresa Unipersonal', articulos:['Art. 5.1 (def.)','RND 10-0010-12 Art. 10.b'], bullets:[
        '1 titular · gestión directa', 'Resp. ilimitada', 'Matrícula — SEPREC (Registro de Comercio)'
      ], hue:'from-cyan-400/30 to-cyan-500/10' },
      { idx:2, id:'srl', nombre:'SRL', articulos:['Arts. 195 y ss.'], bullets:[
        'Hasta 25 socios', 'Cuotas de capital', 'Resp. limitada'
      ], hue:'from-emerald-400/30 to-emerald-500/10' },
      { idx:3, id:'sa', nombre:'S.A.', articulos:['Arts. 217 y ss.'], bullets:[
        'Acciones', 'Junta & Directorio', 'Resp. limitada'
      ], hue:'from-amber-400/30 to-amber-500/10' },
      { idx:4, id:'colectiva', nombre:'Soc. Colectiva', articulos:['Arts. 173 y ss.'], bullets:[
        'Resp. solidaria e ilimitada', 'Administradores', 'Razón social'
      ], hue:'from-fuchsia-400/30 to-fuchsia-500/10' },
      { idx:5, id:'comandita_simple', nombre:'Comandita Simple', articulos:['Arts. 184 y ss.'], bullets:[
        'Gestores (ilimit.)', 'Comanditarios (limit.)', 'Denom. “S.C.S.”'
      ], hue:'from-sky-400/30 to-sky-500/10' },
      { idx:6, id:'sam', nombre:'S.A. Mixta (S.A.M.)', articulos:['Arts. 424 y ss.'], bullets:[
        'Estado + privados', 'Régimen S.A.', 'D.S. constitutivo'
      ], hue:'from-rose-400/30 to-rose-500/10' },
    ];

    const SPECIAL_TYPES = [
      { idx:7, id:'coop_trab', nombre:'Coop. de Trabajo', articulos:['Ley Gral. de Cooperativas'], bullets:[
        'Socios-trabajadores', '1 socio = 1 voto', 'Excedentes por trabajo'
      ], hue:'from-indigo-400/30 to-indigo-500/10' },
      { idx:8, id:'coop_serv', nombre:'Coop. de Servicios', articulos:['Ley Gral. de Cooperativas'], bullets:[
        'Usuarios-socios', 'Tarifas a costo', 'Fiscalización social'
      ], hue:'from-teal-400/30 to-teal-500/10' },
      { idx:9, id:'ep', nombre:'Empresa Pública (EP)', articulos:['Ley de la Empresa Pública'], bullets:[
        'Propiedad estatal', 'Fines eco-sociales', 'Control externo'
      ], hue:'from-purple-400/30 to-purple-500/10' },
    ];

    // =============================
    // Render helpers
    // =============================
    const cardsCode = document.getElementById('cards-code');
    const cardsSpecial = document.getElementById('cards-special');
    const legend = document.getElementById('legend');
    const die = document.getElementById('die');
    const pip = document.getElementById('pip');
    const toggleSpecial = document.getElementById('toggleSpecial');

    function cardHTML(t){
      return `
        <article id="card-${t.idx}" data-testid="card" class="relative rounded-2xl bg-white p-3 text-[12px] shadow-sm hover:shadow transition border border-slate-200">
          <div class="absolute inset-y-0 left-0 w-1 rounded-l-2xl bg-gradient-to-b ${t.hue}"></div>
          <div class="absolute top-1.5 left-2 text-[10px] text-slate-400">${t.idx}</div>
          <div class="flex items-center gap-1.5 font-extrabold text-[13px] text-slate-800">
            <span class="inline-block w-2 h-2 rounded-full bg-gradient-to-r ${t.hue}"></span>
            <span>${t.nombre}</span>
          </div>
          <div class="flex flex-wrap gap-1.5 mt-1.5">${t.articulos.map(a=>`<span class=\"px-1.5 py-0.5 rounded-full border border-slate-200 bg-slate-50 text-[10px] text-slate-600\">${a}</span>`).join('')}</div>
          <ul class="list-disc pl-4 mt-1.5 space-y-0.5 text-slate-700">${t.bullets.map(b=>`<li>${b}</li>`).join('')}</ul>
        </article>`;
    }

    function render(){
      cardsCode.innerHTML = CODE_TYPES.map(cardHTML).join('');
      cardsSpecial.innerHTML = SPECIAL_TYPES.map(cardHTML).join('');
      updateLegend();
    }

    function updateLegend(){
      const active = toggleSpecial.checked ? [...CODE_TYPES, ...SPECIAL_TYPES] : CODE_TYPES;
      legend.innerHTML = active.map(t=>`<span class=\"px-2 py-0.5 rounded-full border border-line\">${t.idx} ${t.nombre}</span>`).join(' ');
    }

    // =============================
    // Dado interactivo (soporta incluir especiales)
    // =============================
    let rolling = false;
    function clearSelected(){
      document.querySelectorAll('.selected').forEach(el=>el.classList.remove('selected','ring-2','ring-cyan-300/50','shadow-cyan-500/10'));
    }
    function selectCardByIndex(n){
      clearSelected();
      const el = document.getElementById(`card-${n}`);
      if(!el) return false;
      el.classList.add('selected','ring-2','ring-cyan-300/50','shadow-cyan-500/10');
      el.scrollIntoView({behavior:'smooth',block:'center',inline:'center'});
      return true;
    }
    function roll(){
      if(rolling) return; rolling = true;
      die.classList.add('roll');
      const max = toggleSpecial.checked ? CODE_TYPES.length + SPECIAL_TYPES.length : CODE_TYPES.length;
      const steps = 12 + Math.floor(Math.random()*8);
      let i=0, n=1;
      const timer = setInterval(()=>{
        n = 1 + Math.floor(Math.random()*max);
        pip.textContent = n;
        i++;
        if(i>=steps){
          clearInterval(timer);
          die.classList.remove('roll');
          selectCardByIndex(n);
          rolling = false;
        }
      }, 55);
    }
    function keyboard(e){
      if(e.code==='Space'){ e.preventDefault(); roll(); }
      const max = toggleSpecial.checked ? CODE_TYPES.length + SPECIAL_TYPES.length : CODE_TYPES.length;
      if(e.key>= '1' && e.key<= String(max)){ pip.textContent = e.key; selectCardByIndex(Number(e.key)); }
    }

    die.addEventListener('click', roll);
    window.addEventListener('keydown', keyboard);
    die.addEventListener('keydown', e=>{ if(e.code==='Space'){ e.preventDefault(); roll(); }});

    toggleSpecial.addEventListener('change', ()=>{ updateLegend(); pip.textContent='—'; clearSelected(); });

    // Init
    render();
    pip.textContent = '—';
  </script>
</body>
</html>
